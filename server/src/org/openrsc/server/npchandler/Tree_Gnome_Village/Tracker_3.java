/**
* Generated By NPCScript :: A scripting engine created for openrsc by Zilent
*/

//scripted by Mr. Zain

package org.openrsc.server.npchandler.Tree_Gnome_Village;
import org.openrsc.server.Config;
import org.openrsc.server.event.DelayedQuestChat;
import org.openrsc.server.model.Npc;
import org.openrsc.server.model.Player;
import org.openrsc.server.model.Quest;
import org.openrsc.server.model.World;
import org.openrsc.server.npchandler.NpcHandler;



public class Tracker_3 implements NpcHandler {

	public void handleNpc(final Npc npc, final Player owner) throws Exception {
		npc.blockedBy(owner);
		owner.setBusy(true);
		Quest q = owner.getQuest(Config.Quests.TREE_GNOME_VILLAGE);
		if(q != null) {
			if(q.finished()) {
				finished(npc, owner);
			} else {
				switch(q.getStage()) {
					case 4:
						questStage4(npc, owner);
						break;
					default:
						noQuestStarted(npc, owner);
						break;
				}
			}
		} 
		else 
		{
			noQuestStarted(npc, owner);
		}
	}
	
	private void noQuestStarted(final Npc npc, final Player owner) {
		World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"All day we pray in the hay, hee hee"}) {
			public void finished() {
			owner.sendMessage("The toll of war has affected his mind");
			owner.setBusy(false);
			npc.unblock();
			}
		});
	}

	private void questStage4(final Npc npc, final Player owner) {
		World.getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"are you okay?"}, true) {
			public void finished() {
				owner.sendMessage("The gnome looks dilerious");
				World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Ok? Who's ok? Not me", "Hee hee"}) {
					public void finished() {
						World.getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"What's wrong?"}) {
							public void finished() {
								World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"You can't see me, no one can", "Monsters, demons, they're all around me"}) {
									public void finished() {
										World.getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"What do you mean?"}) {
											public void finished() {
												World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"They're dancing, all of them hee hee"}) {
													public void finished() {
														owner.sendMessage("He's clearly lost the plot");
														World.getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"Do you have the X coordinate for the khazard stronghold?"}) {
															public void finished() {
																World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"Who holds the stronghold?"}) {
																	public void finished() {
																		World.getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"What?"}) {
																			public void finished() {
																				World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"More than me", "less than our feet"}) {
																					public void finished() {
																						World.getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"You're mad"}) {
																							public void finished() {
																								World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"More than we", "and khazard's men are beat"}) {
																									public void finished() {
																										owner.sendMessage("The toll of war has affected his mind");
																										World.getDelayedEventHandler().add(new DelayedQuestChat(owner, npc, new String[] {"I'll pray for you little man"}) {
																											public void finished() {
																												World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"All day we pray in the hay", "hee hee"}) {
																													public void finished() {
																													owner.sendMessage("The poor gnome has gone mad");
																													owner.setBusy(false);
																													npc.unblock();
																													}
																												});
																											}
																										});
																									}
																								});
																							}
																						});
																					}
																				});
																			}
																		});
																	}
																});
															}
														});
													}
												});
											}
										});
									}
								});
							}
						});
					}
				});
			}
		});
	}

	private void finished(final Npc npc, final Player owner) {
		World.getDelayedEventHandler().add(new DelayedQuestChat(npc, owner, new String[] {"All day we pray in the hay, hee hee"}) {
			public void finished() {
			owner.sendMessage("The toll of war has affected his mind");
			owner.setBusy(false);
			npc.unblock();
			}
		});
	}
	
}